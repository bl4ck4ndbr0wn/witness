{"version":3,"sources":["../../src/controller/profile.js"],"names":["getAll","req","res","profileConfimed","Profile","find","profileConfirmed","exec","send","err","status","json","profile","getByHandle","findOne","handle","params","errors","noprofile","createProfile","profileFields","body","bio","avatar","skills","split","social","youtube","twitter","facebook","linkedin","instagram","then","findOneAndUpdate","$set","new","save"],"mappings":"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","sourcesContent":["import { Profile } from \"../models\";\n\nconst getAll = async (req, res) => {\n  try {\n    const profileConfimed = await Profile.find({\n      profileConfirmed: true\n    }).exec();\n    res.send(profileConfimed);\n  } catch (err) {\n    res.status(404).json({ profile: \"There are no profiles\" });\n  }\n};\n\nconst getByHandle = async (req, res) => {\n  try {\n    const profile = await Profile.findOne({ handle: req.params.handle }).exec();\n    if (!profile) {\n      errors.noprofile = \"There is no profile for this user\";\n      res.status(404).json(errors);\n    }\n\n    res.send(profile);\n  } catch (err) {\n    res.status(404).json(err);\n  }\n};\n\nconst createProfile = (req, res) => {\n  // Get fields\n  const profileFields = {};\n  profileFields.handle = req.body.handle;\n  if (req.body.bio) profileFields.bio = req.body.bio;\n  if (req.body.avatar) profileFields.avatar = req.body.avatar;\n\n  // Skills - Spilt into array\n  if (typeof req.body.skills !== \"undefined\") {\n    profileFields.skills = req.body.skills.split(\",\");\n  }\n\n  // Social\n  profileFields.social = {};\n  if (req.body.youtube) profileFields.social.youtube = req.body.youtube;\n  if (req.body.twitter) profileFields.social.twitter = req.body.twitter;\n  if (req.body.facebook) profileFields.social.facebook = req.body.facebook;\n  if (req.body.linkedin) profileFields.social.linkedin = req.body.linkedin;\n  if (req.body.instagram) profileFields.social.instagram = req.body.instagram;\n\n  profileFields.profileConfirmed = req.body.profileConfirmed;\n\n  Profile.findOne({ handle: profileFields.handle }).then(profile => {\n    if (profile) {\n      // Update\n      Profile.findOneAndUpdate(\n        { handle: profileFields.handle },\n        { $set: profileFields },\n        { new: true }\n      ).then(profile => res.json(profile));\n    } else {\n      // Create\n\n      // Check if handle exists\n      Profile.findOne({ handle: profileFields.handle }).then(profile => {\n        if (profile) {\n          errors.handle = \"That handle already exists\";\n          res.status(400).json(errors);\n        }\n\n        // Save Profile\n        new Profile(profileFields).save().then(profile => res.json(profile));\n      });\n    }\n  });\n};\n\nexport { getAll, getByHandle, createProfile };\n"],"file":"profile.js"}